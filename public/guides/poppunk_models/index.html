<!DOCTYPE html>
<html lang="en-gb">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>A beginner&#39;s guide to fitting PopPUNK models | Pathogen Informatics and Modelling Group</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="A complement to the documentation">
    <meta name="generator" content="Hugo 0.124.1">
    
    
    
    
      <meta name="robots" content="noindex, nofollow">
    

    
<link rel="stylesheet" href="/ananke/css/main.min.css" >



    
    
    
      
<link rel="shortcut icon" href="/images/favicon.svg" type="image/x-icon" />


    

    
    
    <meta property="og:title" content="A beginner&#39;s guide to fitting PopPUNK models" />
<meta property="og:description" content="A complement to the documentation" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://localhost:1313/guides/poppunk_models/" /><meta property="article:section" content="guides" />
<meta property="article:published_time" content="2022-10-18T12:12:42+01:00" />
<meta property="article:modified_time" content="2022-10-18T12:12:42+01:00" />
<meta itemprop="name" content="A beginner&#39;s guide to fitting PopPUNK models">
<meta itemprop="description" content="A complement to the documentation"><meta itemprop="datePublished" content="2022-10-18T12:12:42+01:00" />
<meta itemprop="dateModified" content="2022-10-18T12:12:42+01:00" />
<meta itemprop="wordCount" content="1349">
<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary"/><meta name="twitter:title" content="A beginner&#39;s guide to fitting PopPUNK models"/>
<meta name="twitter:description" content="A complement to the documentation"/>

	



  </head>

  <body class="ma0 avenir bg-near-white">

    
   
  

  
  
  <header class="cover bg-top" style="background-image: url('http://localhost:1313/images/header2.jpg');">
    <div class="bg-black-60">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="/" class="f3 fw2 hover-white no-underline white-90 dib">
      
        <img src="/images/bacpop_logo_3.svg" class="w100 mw5-ns" alt="Pathogen Informatics and Modelling Group" />
      
    </a>
    <div class="flex-l items-center">
      

      
        <ul class="pl0 mr3">
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/group/" title="About us page">
              About us
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/blog/" title="Blogs page">
              Blogs
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/guides/" title="Guides page">
              Guides
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/jobs/" title="Jobs page">
              Jobs
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/poppunk/" title="PopPUNK databases page">
              PopPUNK databases
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/publications/" title="Publications page">
              Publications
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/research/" title="Research page">
              Research
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/resources/" title="Resources page">
              Resources
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/software/" title="Software page">
              Software
            </a>
          </li>
          
        </ul>
      
      
<div class="ananke-socials">
  
    <a href="https://github.com/bacpop" target="_blank" class="github ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="bacpop github link" rel="noopener" aria-label="follow on bacpop github——Opens in a new window">
      
        <span class="icon"><svg style="enable-background:new 0 0 512 512;" version="1.1" viewBox="0 0 512 512"  xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
  <path d="M256,32C132.3,32,32,134.8,32,261.7c0,101.5,64.2,187.5,153.2,217.9c11.2,2.1,15.3-5,15.3-11.1   c0-5.5-0.2-19.9-0.3-39.1c-62.3,13.9-75.5-30.8-75.5-30.8c-10.2-26.5-24.9-33.6-24.9-33.6c-20.3-14.3,1.5-14,1.5-14   c22.5,1.6,34.3,23.7,34.3,23.7c20,35.1,52.4,25,65.2,19.1c2-14.8,7.8-25,14.2-30.7c-49.7-5.8-102-25.5-102-113.5   c0-25.1,8.7-45.6,23-61.6c-2.3-5.8-10-29.2,2.2-60.8c0,0,18.8-6.2,61.6,23.5c17.9-5.1,37-7.6,56.1-7.7c19,0.1,38.2,2.6,56.1,7.7   c42.8-29.7,61.5-23.5,61.5-23.5c12.2,31.6,4.5,55,2.2,60.8c14.3,16.1,23,36.6,23,61.6c0,88.2-52.4,107.6-102.3,113.3   c8,7.1,15.2,21.1,15.2,42.5c0,30.7-0.3,55.5-0.3,63c0,6.1,4,13.3,15.4,11C415.9,449.1,480,363.1,480,261.7   C480,134.8,379.7,32,256,32z"/>
</svg>
</span>
      
<span class="new-window"><svg  height="8px"  style="enable-background:new 0 0 1000 1000;" version="1.1" viewBox="0 0 1000 1000"  xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
<path d="M598 128h298v298h-86v-152l-418 418-60-60 418-418h-152v-86zM810 810v-298h86v298c0 46-40 86-86 86h-596c-48 0-86-40-86-86v-596c0-46 38-86 86-86h298v86h-298v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;"/>
</svg>
</span></a>
  
    <a href="https://youtube.com/@bacpop" target="_blank" class="youtube ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="Bacpop/ScientificProgramming YouTube channel link" rel="noopener" aria-label="follow on Bacpop/ScientificProgramming YouTube channel——Opens in a new window">
      
        <span class="icon"><svg style="enable-background:new 0 0 67 67;" version="1.1" viewBox="0 0 67 67"  xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M42.527,41.34c-0.278,0-0.478,0.078-0.6,0.244  c-0.121,0.156-0.18,0.424-0.18,0.796v0.896h1.543V42.38c0-0.372-0.062-0.64-0.185-0.796C42.989,41.418,42.792,41.34,42.527,41.34z   M36.509,41.309c0.234,0,0.417,0.076,0.544,0.23c0.123,0.155,0.185,0.383,0.185,0.682v4.584c0,0.286-0.053,0.487-0.153,0.611  c-0.1,0.127-0.256,0.189-0.47,0.189c-0.148,0-0.287-0.033-0.421-0.096c-0.135-0.062-0.274-0.171-0.415-0.313v-5.531  c0.119-0.122,0.239-0.213,0.36-0.271C36.26,41.335,36.383,41.309,36.509,41.309z M41.748,44.658v1.672  c0,0.468,0.057,0.792,0.17,0.974c0.118,0.181,0.313,0.269,0.592,0.269c0.289,0,0.491-0.076,0.606-0.229  c0.114-0.153,0.175-0.489,0.175-1.013v-0.405h1.795v0.456c0,0.911-0.217,1.596-0.657,2.059c-0.435,0.459-1.089,0.687-1.958,0.687  c-0.781,0-1.398-0.242-1.847-0.731c-0.448-0.486-0.676-1.157-0.676-2.014v-3.986c0-0.768,0.249-1.398,0.742-1.882  c0.493-0.484,1.128-0.727,1.911-0.727c0.799,0,1.413,0.225,1.843,0.674c0.429,0.448,0.642,1.093,0.642,1.935v2.264H41.748z   M38.623,48.495c-0.271,0.336-0.669,0.501-1.187,0.501c-0.343,0-0.646-0.062-0.912-0.192c-0.267-0.129-0.519-0.327-0.746-0.601  v0.681h-1.764V36.852h1.764v3.875c0.237-0.27,0.485-0.478,0.748-0.616c0.267-0.143,0.534-0.212,0.805-0.212  c0.554,0,0.975,0.189,1.265,0.565c0.294,0.379,0.438,0.933,0.438,1.66v4.926C39.034,47.678,38.897,48.159,38.623,48.495z   M30.958,48.884v-0.976c-0.325,0.361-0.658,0.636-1.009,0.822c-0.349,0.191-0.686,0.282-1.014,0.282  c-0.405,0-0.705-0.129-0.913-0.396c-0.201-0.266-0.305-0.658-0.305-1.189v-7.422h1.744v6.809c0,0.211,0.037,0.362,0.107,0.457  c0.077,0.095,0.196,0.141,0.358,0.141c0.128,0,0.292-0.062,0.488-0.188c0.197-0.125,0.375-0.283,0.542-0.475v-6.744h1.744v8.878  H30.958z M24.916,38.6v10.284h-1.968V38.6h-2.034v-1.748h6.036V38.6H24.916z M32.994,32.978c0-0.001,12.08,0.018,13.514,1.45  c1.439,1.435,1.455,8.514,1.455,8.555c0,0-0.012,7.117-1.455,8.556C45.074,52.969,32.994,53,32.994,53s-12.079-0.031-13.516-1.462  c-1.438-1.435-1.441-8.502-1.441-8.556c0-0.041,0.004-7.12,1.441-8.555C20.916,32.996,32.994,32.977,32.994,32.978z M42.52,29.255  h-1.966v-1.08c-0.358,0.397-0.736,0.703-1.13,0.909c-0.392,0.208-0.771,0.312-1.14,0.312c-0.458,0-0.797-0.146-1.027-0.437  c-0.229-0.291-0.345-0.727-0.345-1.311v-8.172h1.962v7.497c0,0.231,0.045,0.399,0.127,0.502c0.08,0.104,0.216,0.156,0.399,0.156  c0.143,0,0.327-0.069,0.548-0.206c0.22-0.137,0.423-0.312,0.605-0.527v-7.422h1.966V29.255z M31.847,27.588  c0.139,0.147,0.339,0.219,0.6,0.219c0.266,0,0.476-0.075,0.634-0.223c0.157-0.152,0.235-0.358,0.235-0.618v-5.327  c0-0.214-0.08-0.387-0.241-0.519c-0.16-0.131-0.37-0.196-0.628-0.196c-0.241,0-0.435,0.065-0.586,0.196  c-0.148,0.132-0.225,0.305-0.225,0.519v5.327C31.636,27.233,31.708,27.439,31.847,27.588z M30.408,19.903  c0.528-0.449,1.241-0.674,2.132-0.674c0.812,0,1.48,0.237,2.001,0.711c0.517,0.473,0.777,1.083,0.777,1.828v5.051  c0,0.836-0.255,1.491-0.762,1.968c-0.513,0.476-1.212,0.714-2.106,0.714c-0.858,0-1.547-0.246-2.064-0.736  c-0.513-0.492-0.772-1.152-0.772-1.983v-5.068C29.613,20.954,29.877,20.351,30.408,19.903z M24.262,16h-2.229l2.634,8.003v5.252  h2.213v-5.5L29.454,16h-2.25l-1.366,5.298h-0.139L24.262,16z M33,64C16.432,64,3,50.569,3,34S16.432,4,33,4s30,13.431,30,30  S49.568,64,33,64z" style="fill-rule:evenodd;clip-rule:evenodd;"/></svg>
</span>
      
<span class="new-window"><svg  height="8px"  style="enable-background:new 0 0 1000 1000;" version="1.1" viewBox="0 0 1000 1000"  xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
<path d="M598 128h298v298h-86v-152l-418 418-60-60 418-418h-152v-86zM810 810v-298h86v298c0 46-40 86-86 86h-596c-48 0-86-40-86-86v-596c0-46 38-86 86-86h298v86h-298v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;"/>
</svg>
</span></a>
  
</div>

    </div>
  </div>
</nav>

      <div class="tc-l pv6 ph3 ph4-ns">
        
          <h1 class="f2 f1-l fw2 white-90 mb0 lh-title">A beginner&#39;s guide to fitting PopPUNK models</h1>
          
            <h2 class="fw1 f5 f3-l white-80 measure-wide-l center lh-copy mt3 mb4">
              A complement to the documentation
            </h2>
          
        
      </div>
    </div>
  </header>



    <main class="pb7" role="main">
      
  
  <article class="flex-l flex-wrap justify-between mw8 center ph3">
    <header class="mt4 w-100">
      <aside class="instapaper_ignoref b helvetica tracked">
          
        GUIDES
      </aside>
      










  <div id="sharing" class="mt3 ananke-socials">
    
  </div>


      <h1 class="f1 athelas mt3 mb1">A beginner&#39;s guide to fitting PopPUNK models</h1>
      
      <p class="tracked">
        By <strong>John Lees</strong>
      </p>
      
      
      
      <time class="f6 mv4 dib tracked" datetime="2022-10-18T12:12:42+01:00">October 18, 2022</time>
      

      
      
    </header>
    <div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><p><a href="https://www.poppunk.net/">PopPUNK</a> now has a lot of different models available,
which can make it hard to know where to start, or to tell if you&rsquo;ve done the right
thing when fitting one to your data.</p>
<p>Some questions I&rsquo;ll address:</p>
<div>
    <nav id="TableOfContents">
  <ul>
    <li><a href="#do-you-need-to-fit-a-new-model">Do you need to fit a new model?</a></li>
    <li><a href="#should-i-subsample-my-data">Should I subsample my data?</a></li>
    <li><a href="#which-model-should-i-use">Which model should I use?</a></li>
    <li><a href="#are-my-clusters-correct">Are my clusters correct?</a></li>
    <li><a href="#my-clusters-dont-match-mlstcc">My clusters don&rsquo;t match MLST/CC</a></li>
  </ul>
</nav>
</div>

<p>tl;dr</p>
<ul>
<li>Don&rsquo;t fit a model if you don&rsquo;t have to.</li>
<li>Try and use a refine/boundary model.</li>
<li>Make sure your component near the origin is sensible (not too big or too small), don&rsquo;t just rely on the network score.</li>
<li>Check your clusters on a tree, in microreact or by somehow visualising them.</li>
</ul>
<h2 id="do-you-need-to-fit-a-new-model">Do you need to fit a new model?</h2>
<p>If there is an existing one you can download
from <a href="https://www.poppunk.net/databases">databases</a> then you can usually forgo this
step entirely. As well as avoiding extra work and validation, you&rsquo;ll also get consistent
cluster names with other studies, which is a big advantage.</p>
<p>If your species isn&rsquo;t listed, then you are going to need to fit a model. If you&rsquo;re happy
with your fit, we&rsquo;d encourage you to share it with us (no need to share genome data) so we
can add it to the database list. Others will be able to benefit from it, and it will
build momentum for your nomenclature.</p>
<p>The other case is where the given model isn&rsquo;t exactly the resolution you want (too many,
or not enough clusters). In this case you probably want to try something like
<code>--multi-boundary</code> to get a few alternatives to compare.</p>
<p>A bad time to fit a new model is if you have a different dataset but the same species
as an existing model &ndash; it&rsquo;s always worth trying the existing model first.</p>
<h2 id="should-i-subsample-my-data">Should I subsample my data?</h2>
<p>No, but you should definitely <a href="https://poppunk.readthedocs.io/en/latest/qc.html">run the QC</a> on it,
and be fairly strict about including samples. It&rsquo;s often possible to get an assignment afterwards for any you
exclude at this step.</p>
<h2 id="which-model-should-i-use">Which model should I use?</h2>
<p>See <a href="https://poppunk.readthedocs.io/en/latest/model_fitting.html">https://poppunk.readthedocs.io/en/latest/model_fitting.html</a></p>
<p><strong>The ideal model is usually one with a 2D boundary</strong>: it&rsquo;s simple, fast to assign new samples with,
and very portable.</p>
<p>How do we get there though? Usually in two steps: first by fitting a BGMM or DBSCAN model, then
running a second refine model. But here&rsquo;s a list of possible approaches:</p>
<h3 id="thresholdhttpspoppunkreadthedocsioenlatestmodel_fittinghtmlthreshold"><a href="https://poppunk.readthedocs.io/en/latest/model_fitting.html#threshold">Threshold</a></h3>
<p>If you want to define a simple core distance cutoff, this is easily done with a threshold model,
which is just a special case of 2D boundary models. You need to know/choose where to join the boundary,
so you may need to try a few values and see if your clusters are any good. But these are totally valid
and often useful models.</p>
<h3 id="bgmmhttpspoppunkreadthedocsioenlatestmodel_fittinghtmlbgmm"><a href="https://poppunk.readthedocs.io/en/latest/model_fitting.html#bgmm">BGMM</a></h3>
<p>This is really only a useful starting point if you have a small number of samples (at most a few
hundred) and you have clear ellipse shaped features in the core-distance plot. It does a pretty good job
of find density centroids however, so can be useful to find points to run with manual start.</p>
<p>Changing/iterating different values of the number of components <code>--K</code> is rarely useful, as there is almost always enough
data to support larger numbers of components.</p>
<p>We&rsquo;ve found this the best way to make initial models with small amounts of data, but as there is little
information on a specific boundary their performance can degrade as larger numbers of samples are added. So
it&rsquo;s usually better to refine it, or re-fit when a larger number of samples are obtained.</p>
<h3 id="dbscanhttpspoppunkreadthedocsioenlatestmodel_fittinghtmldbscan"><a href="https://poppunk.readthedocs.io/en/latest/model_fitting.html#dbscan">DBSCAN</a></h3>
<p>This is a pretty useful way to get a <em>starting point</em> for subsequent model refinement.</p>
<p>The problem with DBSCAN models is that:</p>
<ul>
<li>The within-strain component, the most important one, is frequently too small and includes
a scatter of points near the origin, giving far too many clusters.</li>
<li>They are relatively slow to assign to (this may improve in future, with GPU acceleration).</li>
<li>They are a few package dependencies, which have not remained backwards compatible.</li>
</ul>
<p>As DBSCAN model can leave points unassigned (noise points; plotted in black), if you have a lot of these the network may be sparser than expected and lead to less consistent clustering (maybe? I don&rsquo;t think we&rsquo;ve ever actually seen this in practise). So it&rsquo;s usually better to run refinement on them.</p>
<h3 id="refinehttpspoppunkreadthedocsioenlatestmodel_fittinghtmlrefine"><a href="https://poppunk.readthedocs.io/en/latest/model_fitting.html#refine">Refine</a></h3>
<p>This is the canonical way to get a 2D boundary model. Model refinement has many options
and flavours, but it all essentially works like this:</p>
<ol>
<li>Define a start and end point, and draw a line between them.</li>
<li>Draw boundaries perpendicular to this line.</li>
<li>For each of these boundaries, try using this as a model, and assess the cluster quality using a network score.</li>
<li>Pick the boundary which gave the best network score.</li>
</ol>
<figure><img src="/images/poppunk/refine_wb.jpg"
    alt="Cartoon of the refine process. A line is drawn from start to end, and boundaries constructed perpendicular to this (red lines). The blue line with the highest network score is chosen as the output."><figcaption>
      <p>Cartoon of the refine process. A line is drawn from start to end, and boundaries constructed perpendicular to this (red lines). The blue line with the highest network score is chosen as the output.</p>
    </figcaption>
</figure>

<p>The start and end point are defined as the clusters closests and second closest to the origin,
in the first (BGMM or DBSCAN) model. The idea is that although <a href="https://doi.org/10.1101/2022.10.08.511450">all of these boundaries are likely to
produce valid sets of clusters</a>, the heuristics we use in the network score tend to produce ones
which are useful for typical purposes.</p>
<p>Then the following modifications are possible:</p>
<ul>
<li>Define the start and end point <a href="https://poppunk.readthedocs.io/en/latest/model_fitting.html#using-fit-refinement-when-mixture-model-totally-fails">manually</a>, using <code>--manual-start</code>.</li>
<li>Use a <a href="https://poppunk.readthedocs.io/en/latest/model_fitting.html#alternative-network-scores">different network score</a> which penalise cluster joining more (useful for very large datasets).</li>
<li>Only test vertical or horizontal boundaries, i.e. <a href="https://poppunk.readthedocs.io/en/latest/model_fitting.html#using-core-accessory-only">core-only or accessory-only</a>, with <code>--indiv-refine</code>.</li>
<li>Output all of the tested boundary positions rather the top scoring one with <code>--multi-boundary</code>. These
can then be combined with <a href="https://poppunk.readthedocs.io/en/latest/scripts.html#iterative-poppunk">iterative-PopPUNK</a>.
Great for multiple resolutions, or when trying to work out where you want the boundary to be.</li>
<li><a href="https://poppunk.readthedocs.io/en/latest/model_fitting.html#unconstrained-two-dimensional-optimisation">Try different gradients</a> of the boundary at each position (see below) with <code>--unconstrained</code> which is useful when the clusters are at a different angle to the line between start and end, at the cost of more computation.</li>
</ul>
<figure><img src="/images/poppunk/refine_2d_wb.jpg"
    alt="In unconstrained refinement, at each point different gradients of boundaries are also tested."><figcaption>
      <p>In unconstrained refinement, at each point different gradients of boundaries are also tested.</p>
    </figcaption>
</figure>

<h3 id="lineagehttpspoppunkreadthedocsioenlatestmodel_fittinghtmllineage"><a href="https://poppunk.readthedocs.io/en/latest/model_fitting.html#lineage">Lineage</a></h3>
<p>Good for when you have closely related data, or trying to find subclusters. Only a single
parameter (<code>--ranks</code>) so very easy to try.</p>
<h2 id="are-my-clusters-correct">Are my clusters correct?</h2>
<p>Clusters aren&rsquo;t really right or wrong as there is no ground truth in real datasets.
But clusters can be more or less useful, and this probably depends on your desired use of them.</p>
<p>Typically, PopPUNK clusters will broadly agree with a tree (i.e. there are not many polyphyletic clusters),
but you might get more than you want, or not enough resolution. Resolution varying across the tree
is not usually a problem.</p>
<p>Good checks include:</p>
<ul>
<li>How many clusters do I have? Too many, or not enough?</li>
<li>Do I have any clearly merged clusters or high betweenness samples in the network?</li>
<li>Are my clusters consistent with the tree (you can calculate the number of samples in the same
clusters under each ancestor, <a href="https://wellcomeopenresearch.org/articles/3-33">for example</a>).</li>
<li>Does a visualisation/microreact look alright? Zoom in on some of the larger clusters.</li>
</ul>
<h2 id="my-clusters-dont-match-mlstcc">My clusters don&rsquo;t match MLST/CC</h2>
<p>Perhaps first ask, does this matter? MLST is certainly not the ground truth!
CC isn&rsquo;t consistent between runs and datasets, so in my opinion shouldn&rsquo;t be used (but
is fine as a cluster alias, where its use has already been established).</p>
<p>One MLST may have many PopPUNK clusters, or one PopPUNK clusters may have many MLSTs (and you can
even quantify this with <a href="https://poppunk.readthedocs.io/en/latest/scripts.html#calculating-rand-indices">some of the included scripts</a>). Neither of these mean the clusters are &lsquo;wrong&rsquo;.</p>
<p>Generally these 7-gene schemes have poor resolution/not enough clusters, and sometimes even suffer
from bigger problems (including a recombinant gene, so in some places you get too
many types; or worse, a paralogous gene so assignment is not even clear). But if you
think the MLST scheme is good, you can always pick the boundary that gives you the closest match
between clusters.</p>
<p>In many commonly sequenced species, MLST schemes define a well-known nomenclature that you may wish
to keep referring too &ndash; the best way to keep this compatibility is with
<a href="https://poppunk.readthedocs.io/en/latest/query_assignment.html#adding-external-cluster-labels-mlst-cc-etc"><code>--external-clustering</code></a>.</p>
<ul class="pa0">
  
</ul>
<div class="mt6 instapaper_ignoref">
      
      
      </div>
    </div>

    <aside class="w-30-l mt6-l">




</aside>

  </article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="http://localhost:1313/" >
    &copy;  Pathogen Informatics and Modelling Group 2024 
  </a>
    <div>
<div class="ananke-socials">
  
    <a href="https://github.com/bacpop" target="_blank" class="github ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="bacpop github link" rel="noopener" aria-label="follow on bacpop github——Opens in a new window">
      
        <span class="icon"><svg style="enable-background:new 0 0 512 512;" version="1.1" viewBox="0 0 512 512"  xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
  <path d="M256,32C132.3,32,32,134.8,32,261.7c0,101.5,64.2,187.5,153.2,217.9c11.2,2.1,15.3-5,15.3-11.1   c0-5.5-0.2-19.9-0.3-39.1c-62.3,13.9-75.5-30.8-75.5-30.8c-10.2-26.5-24.9-33.6-24.9-33.6c-20.3-14.3,1.5-14,1.5-14   c22.5,1.6,34.3,23.7,34.3,23.7c20,35.1,52.4,25,65.2,19.1c2-14.8,7.8-25,14.2-30.7c-49.7-5.8-102-25.5-102-113.5   c0-25.1,8.7-45.6,23-61.6c-2.3-5.8-10-29.2,2.2-60.8c0,0,18.8-6.2,61.6,23.5c17.9-5.1,37-7.6,56.1-7.7c19,0.1,38.2,2.6,56.1,7.7   c42.8-29.7,61.5-23.5,61.5-23.5c12.2,31.6,4.5,55,2.2,60.8c14.3,16.1,23,36.6,23,61.6c0,88.2-52.4,107.6-102.3,113.3   c8,7.1,15.2,21.1,15.2,42.5c0,30.7-0.3,55.5-0.3,63c0,6.1,4,13.3,15.4,11C415.9,449.1,480,363.1,480,261.7   C480,134.8,379.7,32,256,32z"/>
</svg>
</span>
      
<span class="new-window"><svg  height="8px"  style="enable-background:new 0 0 1000 1000;" version="1.1" viewBox="0 0 1000 1000"  xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
<path d="M598 128h298v298h-86v-152l-418 418-60-60 418-418h-152v-86zM810 810v-298h86v298c0 46-40 86-86 86h-596c-48 0-86-40-86-86v-596c0-46 38-86 86-86h298v86h-298v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;"/>
</svg>
</span></a>
  
    <a href="https://youtube.com/@bacpop" target="_blank" class="youtube ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="Bacpop/ScientificProgramming YouTube channel link" rel="noopener" aria-label="follow on Bacpop/ScientificProgramming YouTube channel——Opens in a new window">
      
        <span class="icon"><svg style="enable-background:new 0 0 67 67;" version="1.1" viewBox="0 0 67 67"  xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M42.527,41.34c-0.278,0-0.478,0.078-0.6,0.244  c-0.121,0.156-0.18,0.424-0.18,0.796v0.896h1.543V42.38c0-0.372-0.062-0.64-0.185-0.796C42.989,41.418,42.792,41.34,42.527,41.34z   M36.509,41.309c0.234,0,0.417,0.076,0.544,0.23c0.123,0.155,0.185,0.383,0.185,0.682v4.584c0,0.286-0.053,0.487-0.153,0.611  c-0.1,0.127-0.256,0.189-0.47,0.189c-0.148,0-0.287-0.033-0.421-0.096c-0.135-0.062-0.274-0.171-0.415-0.313v-5.531  c0.119-0.122,0.239-0.213,0.36-0.271C36.26,41.335,36.383,41.309,36.509,41.309z M41.748,44.658v1.672  c0,0.468,0.057,0.792,0.17,0.974c0.118,0.181,0.313,0.269,0.592,0.269c0.289,0,0.491-0.076,0.606-0.229  c0.114-0.153,0.175-0.489,0.175-1.013v-0.405h1.795v0.456c0,0.911-0.217,1.596-0.657,2.059c-0.435,0.459-1.089,0.687-1.958,0.687  c-0.781,0-1.398-0.242-1.847-0.731c-0.448-0.486-0.676-1.157-0.676-2.014v-3.986c0-0.768,0.249-1.398,0.742-1.882  c0.493-0.484,1.128-0.727,1.911-0.727c0.799,0,1.413,0.225,1.843,0.674c0.429,0.448,0.642,1.093,0.642,1.935v2.264H41.748z   M38.623,48.495c-0.271,0.336-0.669,0.501-1.187,0.501c-0.343,0-0.646-0.062-0.912-0.192c-0.267-0.129-0.519-0.327-0.746-0.601  v0.681h-1.764V36.852h1.764v3.875c0.237-0.27,0.485-0.478,0.748-0.616c0.267-0.143,0.534-0.212,0.805-0.212  c0.554,0,0.975,0.189,1.265,0.565c0.294,0.379,0.438,0.933,0.438,1.66v4.926C39.034,47.678,38.897,48.159,38.623,48.495z   M30.958,48.884v-0.976c-0.325,0.361-0.658,0.636-1.009,0.822c-0.349,0.191-0.686,0.282-1.014,0.282  c-0.405,0-0.705-0.129-0.913-0.396c-0.201-0.266-0.305-0.658-0.305-1.189v-7.422h1.744v6.809c0,0.211,0.037,0.362,0.107,0.457  c0.077,0.095,0.196,0.141,0.358,0.141c0.128,0,0.292-0.062,0.488-0.188c0.197-0.125,0.375-0.283,0.542-0.475v-6.744h1.744v8.878  H30.958z M24.916,38.6v10.284h-1.968V38.6h-2.034v-1.748h6.036V38.6H24.916z M32.994,32.978c0-0.001,12.08,0.018,13.514,1.45  c1.439,1.435,1.455,8.514,1.455,8.555c0,0-0.012,7.117-1.455,8.556C45.074,52.969,32.994,53,32.994,53s-12.079-0.031-13.516-1.462  c-1.438-1.435-1.441-8.502-1.441-8.556c0-0.041,0.004-7.12,1.441-8.555C20.916,32.996,32.994,32.977,32.994,32.978z M42.52,29.255  h-1.966v-1.08c-0.358,0.397-0.736,0.703-1.13,0.909c-0.392,0.208-0.771,0.312-1.14,0.312c-0.458,0-0.797-0.146-1.027-0.437  c-0.229-0.291-0.345-0.727-0.345-1.311v-8.172h1.962v7.497c0,0.231,0.045,0.399,0.127,0.502c0.08,0.104,0.216,0.156,0.399,0.156  c0.143,0,0.327-0.069,0.548-0.206c0.22-0.137,0.423-0.312,0.605-0.527v-7.422h1.966V29.255z M31.847,27.588  c0.139,0.147,0.339,0.219,0.6,0.219c0.266,0,0.476-0.075,0.634-0.223c0.157-0.152,0.235-0.358,0.235-0.618v-5.327  c0-0.214-0.08-0.387-0.241-0.519c-0.16-0.131-0.37-0.196-0.628-0.196c-0.241,0-0.435,0.065-0.586,0.196  c-0.148,0.132-0.225,0.305-0.225,0.519v5.327C31.636,27.233,31.708,27.439,31.847,27.588z M30.408,19.903  c0.528-0.449,1.241-0.674,2.132-0.674c0.812,0,1.48,0.237,2.001,0.711c0.517,0.473,0.777,1.083,0.777,1.828v5.051  c0,0.836-0.255,1.491-0.762,1.968c-0.513,0.476-1.212,0.714-2.106,0.714c-0.858,0-1.547-0.246-2.064-0.736  c-0.513-0.492-0.772-1.152-0.772-1.983v-5.068C29.613,20.954,29.877,20.351,30.408,19.903z M24.262,16h-2.229l2.634,8.003v5.252  h2.213v-5.5L29.454,16h-2.25l-1.366,5.298h-0.139L24.262,16z M33,64C16.432,64,3,50.569,3,34S16.432,4,33,4s30,13.431,30,30  S49.568,64,33,64z" style="fill-rule:evenodd;clip-rule:evenodd;"/></svg>
</span>
      
<span class="new-window"><svg  height="8px"  style="enable-background:new 0 0 1000 1000;" version="1.1" viewBox="0 0 1000 1000"  xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
<path d="M598 128h298v298h-86v-152l-418 418-60-60 418-418h-152v-86zM810 810v-298h86v298c0 46-40 86-86 86h-596c-48 0-86-40-86-86v-596c0-46 38-86 86-86h298v86h-298v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;"/>
</svg>
</span></a>
  
</div>
</div>
  </div>
</footer>

  </body>
</html>
